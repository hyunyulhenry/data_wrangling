<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 11 Import Data | R을 이용한 데이터 랭글링</title>
<meta name="author" content="이현열 (Henry Lee)">
<meta name="description" content="데이터 분석의 첫번째 단계는 데이터를 불러오는 것이며, 일반적으로 텍스트 혹은 엑셀 파일로 저장된 데이터를 사용합니다. 아래와 같은 데이터가 각각 csv, excel, RDS 파일로 저장된 예제를 살펴보겠습니다. variable 1, variable 2, variable 3 10,beer,TRUE 25,wine,TRUE 8,cheese,FALSE...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="Chapter 11 Import Data | R을 이용한 데이터 랭글링">
<meta property="og:type" content="book">
<meta property="og:url" content="https://hyunyulhenry.github.io/data_wrangling/import-data.html">
<meta property="og:description" content="데이터 분석의 첫번째 단계는 데이터를 불러오는 것이며, 일반적으로 텍스트 혹은 엑셀 파일로 저장된 데이터를 사용합니다. 아래와 같은 데이터가 각각 csv, excel, RDS 파일로 저장된 예제를 살펴보겠습니다. variable 1, variable 2, variable 3 10,beer,TRUE 25,wine,TRUE 8,cheese,FALSE...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 11 Import Data | R을 이용한 데이터 랭글링">
<meta name="twitter:description" content="데이터 분석의 첫번째 단계는 데이터를 불러오는 것이며, 일반적으로 텍스트 혹은 엑셀 파일로 저장된 데이터를 사용합니다. 아래와 같은 데이터가 각각 csv, excel, RDS 파일로 저장된 예제를 살펴보겠습니다. variable 1, variable 2, variable 3 10,beer,TRUE 25,wine,TRUE 8,cheese,FALSE...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R을 이용한 데이터 랭글링</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li class="book-part">데이터 타입별 다루기</li>
<li><a class="" href="numbers.html"><span class="header-section-number">1</span> Numbers</a></li>
<li><a class="" href="character-strings.html"><span class="header-section-number">2</span> Character Strings</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">3</span> Factors</a></li>
<li><a class="" href="date.html"><span class="header-section-number">4</span> Date</a></li>
<li class="book-part">데이터 구조 다루기</li>
<li><a class="" href="data-structure-basics.html"><span class="header-section-number">5</span> Data Structure Basics</a></li>
<li><a class="" href="vector.html"><span class="header-section-number">6</span> Vector</a></li>
<li><a class="" href="list.html"><span class="header-section-number">7</span> List</a></li>
<li><a class="" href="matrix.html"><span class="header-section-number">8</span> Matrix</a></li>
<li><a class="" href="data-frame.html"><span class="header-section-number">9</span> Data Frame</a></li>
<li><a class="" href="missing-value.html"><span class="header-section-number">10</span> Missing Value</a></li>
<li class="book-part">데이터 불러오기 및 내보내기</li>
<li><a class="active" href="import-data.html"><span class="header-section-number">11</span> Import Data</a></li>
<li><a class="" href="exporting-data.html"><span class="header-section-number">12</span> Exporting Data</a></li>
<li class="book-part">효율적이고 가독성 높은 코드</li>
<li><a class="" href="%ED%95%A8%EC%88%98.html"><span class="header-section-number">13</span> 함수</a></li>
<li><a class="" href="loop-statement.html"><span class="header-section-number">14</span> Loop Statement</a></li>
<li><a class="" href="pipe-operator.html"><span class="header-section-number">15</span> Pipe Operator (%&gt;%)</a></li>
<li class="book-part">데이터 구조 변형하기</li>
<li><a class="" href="tidyr%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%AA%A8%EC%96%91-%EB%B0%94%EA%BE%B8%EA%B8%B0.html"><span class="header-section-number">16</span> tidyr을 이용한 데이터 모양 바꾸기</a></li>
<li><a class="" href="dplyr%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B3%80%ED%98%95%ED%95%98%EA%B8%B0.html"><span class="header-section-number">17</span> dplyr을 이용한 데이터 변형하기</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="import-data" class="section level1" number="11">
<h1>
<span class="header-section-number">11</span> Import Data<a class="anchor" aria-label="anchor" href="#import-data"><i class="fas fa-link"></i></a>
</h1>
<p>데이터 분석의 첫번째 단계는 데이터를 불러오는 것이며, 일반적으로 텍스트 혹은 엑셀 파일로 저장된 데이터를 사용합니다.</p>
<p>아래와 같은 데이터가 각각 csv, excel, RDS 파일로 저장된 예제를 살펴보겠습니다.</p>
<pre><code>variable 1, variable 2, variable 3
10,beer,TRUE
25,wine,TRUE
8,cheese,FALSE</code></pre>
<p>해당 파일의 주소는 다음과 같습니다.</p>
<pre><code>csv: https://github.com/hyunyulhenry/data_wrangling/blob/master/mydata.csv
txt: https://github.com/hyunyulhenry/data_wrangling/blob/master/mydata.txt
excel: https://github.com/hyunyulhenry/data_wrangling/blob/master/mydata.xlsx
rds: https://github.com/hyunyulhenry/data_wrangling/blob/master/mydata.rds</code></pre>
<p>먼저 다음 코드를 이용해 해당 파일들을 다운로드 받도록 합니다.</p>
<div class="sourceCode" id="cb302"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="st">'https://raw.githubusercontent.com/hyunyulhenry/data_wrangling/master/mydata.csv'</span>, <span class="st">'mydata.csv'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="st">'https://raw.githubusercontent.com/hyunyulhenry/data_wrangling/master/mydata.txt'</span>, <span class="st">'mydata.txt'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="st">'https://github.com/hyunyulhenry/data_wrangling/raw/master/mydata.xlsx'</span>,<span class="st">'mydata.xlsx'</span>, mode <span class="op">=</span> <span class="st">'wb'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="st">'https://github.com/hyunyulhenry/data_wrangling/raw/master/mydata.rds'</span>,<span class="st">'mydata.rds'</span><span class="op">)</span></code></pre></div>
<div id="csv-파일-불러오기" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> csv 파일 불러오기<a class="anchor" aria-label="anchor" href="#csv-%ED%8C%8C%EC%9D%BC-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0"><i class="fas fa-link"></i></a>
</h2>
<p>먼저 R의 기본함수와 <code>readr</code> 패키지를 이용하여 csv 파일을 불러오는 법에 대해 살펴보겠습니다.</p>
<div id="기본함수" class="section level3" number="11.1.1">
<h3>
<span class="header-section-number">11.1.1</span> 기본함수<a class="anchor" aria-label="anchor" href="#%EA%B8%B0%EB%B3%B8%ED%95%A8%EC%88%98"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> 함수는 데이터를 불러오는 R의 가장 기본인 함수며, <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code>와 <code><a href="https://rdrr.io/r/utils/read.table.html">read.delim()</a></code> 함수는 특수한 경우의 래퍼 함수라 볼 수 있습니다.</p>
<div class="sourceCode" id="cb303"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mydata</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">'mydata.csv'</span><span class="op">)</span>
<span class="va">mydata</span></code></pre></div>
<pre><code>##   variable.1 variable.2 variable.3
## 1         10       beer       TRUE
## 2         25       wine       TRUE
## 3          8     cheese      FALSE</code></pre>
<div class="sourceCode" id="cb305"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></code></pre></div>
<pre><code>## 'data.frame':    3 obs. of  3 variables:
##  $ variable.1: int  10 25 8
##  $ variable.2: chr  "beer" "wine" "cheese"
##  $ variable.3: logi  TRUE TRUE FALSE</code></pre>
<p>먼저 열이름인 variable 다음에 점(.)이 붙은 것이 확인됩니다. 이처럼 기본함수를 사용할 경우 열 이름의 공백은 점으로 바뀌게 됩니다.</p>
<p>또한 variable 2의 문자열이 자동으로 팩터 형태로 바뀌게 되었습니다. 이를 방지하기 위해서는 stringAsFactors를 FALSE로 지정해주어야 합니다.</p>
<div class="sourceCode" id="cb307"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mydata2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">'mydata.csv'</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">mydata2</span><span class="op">)</span></code></pre></div>
<pre><code>## 'data.frame':    3 obs. of  3 variables:
##  $ variable.1: int  10 25 8
##  $ variable.2: chr  "beer" "wine" "cheese"
##  $ variable.3: logi  TRUE TRUE FALSE</code></pre>
<p><code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> 함수를 이용하여 csv 데이터를 불러올 수도 있습니다.</p>
<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">'mydata.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>##   variable.1 variable.2 variable.3
## 1         10       beer       TRUE
## 2         25       wine       TRUE
## 3          8     cheese      FALSE</code></pre>
<p>구분자에 해당하는 sep를 ’,’로 지정해 주며, 열이름에 해당하는 header를 TRUE로 지정해줍니다.</p>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">'mydata.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>,
           row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Row 1'</span>, <span class="st">'Row 2'</span>, <span class="st">'Row 3'</span><span class="op">)</span>,
           col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Var 1'</span>, <span class="st">'Var 2'</span>, <span class="st">'Var 3'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##       Var.1  Var.2 Var.3
## Row 1    10   beer  TRUE
## Row 2    25   wine  TRUE
## Row 3     8 cheese FALSE</code></pre>
<p>row.names와 col.names 인자를 통해 행 및 열이름을 직접 지정할 수도 있습니다.</p>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">set_classes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">'mydata.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, header <span class="op">=</span> <span class="cn">TRUE</span>,
                         colClasses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'numeric'</span>, <span class="st">'character'</span>, <span class="st">'character'</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">set_classes</span><span class="op">)</span></code></pre></div>
<pre><code>## 'data.frame':    3 obs. of  3 variables:
##  $ variable.1: num  10 25 8
##  $ variable.2: chr  "beer" "wine" "cheese"
##  $ variable.3: chr  "TRUE" "TRUE" "FALSE"</code></pre>
<p>colClasses 인자를 통해 각 열에 해당하는 클래스를 직접 지정해줄 수도 있으며, 2번째 열이 팩터가 아닌 문자 형태로 입력됩니다.</p>
<div class="sourceCode" id="cb315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">'mydata.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, nrows <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>##   variable.1 variable.2 variable.3
## 1         10       beer       TRUE
## 2         25       wine       TRUE</code></pre>
<p>nrows 인자를 통해 전체 데이터가 아닌 지정한 행까지의 데이터만 불러올 수도 있습니다.</p>
</div>
<div id="readr-패키지" class="section level3" number="11.1.2">
<h3>
<span class="header-section-number">11.1.2</span> <code>readr</code> 패키지<a class="anchor" aria-label="anchor" href="#readr-%ED%8C%A8%ED%82%A4%EC%A7%80"><i class="fas fa-link"></i></a>
</h3>
<p>기본 함수 대비 readr 패키지를 이용할 경우 10배 정도 빠르게 데이터를 불러올 수 있습니다.</p>
<div class="sourceCode" id="cb317"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span>
<span class="va">mydata3</span> <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">'mydata.csv'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">mydata3</span><span class="op">)</span></code></pre></div>
<pre><code>## spec_tbl_df [3 x 3] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
##  $ variable 1: num [1:3] 10 25 8
##  $ variable 2: chr [1:3] "beer" "wine" "cheese"
##  $ variable 3: logi [1:3] TRUE TRUE FALSE
##  - attr(*, "spec")=
##   .. cols(
##   ..   `variable 1` = col_double(),
##   ..   `variable 2` = col_character(),
##   ..   `variable 3` = col_logical()
##   .. )
##  - attr(*, "problems")=&lt;externalptr&gt;</code></pre>
<p><code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> 함수를 이용해 csv 파일을 불러올 수 있습니다. 열이름의 공백이 그대로 유지되며, 문자 형태 역시 팩터가 아닌 원래 형식이 그대로 유지됩니다.</p>
<div class="sourceCode" id="cb319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">'mydata.csv'</span>, col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_double</a></span><span class="op">(</span><span class="op">)</span>,
                                        <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_character</a></span><span class="op">(</span><span class="op">)</span>,
                                        <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   `variable 1` `variable 2` `variable 3`
##          &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       
## 1           10 beer         TRUE        
## 2           25 wine         TRUE        
## 3            8 cheese       FALSE</code></pre>
<p>col_types 인자를 통해 원하는 타입을 직접 입력할 수도 있습니다.</p>
<div class="sourceCode" id="cb321"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">'mydata.csv'</span>, col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Var 1'</span>, <span class="st">'Var 2'</span>, <span class="st">'Var 3'</span><span class="op">)</span>,
         skip <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   `Var 1` `Var 2` `Var 3`
##     &lt;dbl&gt; &lt;chr&gt;   &lt;lgl&gt;  
## 1      10 beer    TRUE   
## 2      25 wine    TRUE   
## 3       8 cheese  FALSE</code></pre>
<p>col_names 인자를 통해 열이름을 입력할 수 있으며, skip을 통해 위에서 n번째 행을 건너뛰고 데이터를 불러올 수 있습니다.</p>
<div class="sourceCode" id="cb323"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">'mydata.csv'</span>, n_max <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   `variable 1` `variable 2` `variable 3`
##          &lt;dbl&gt; &lt;chr&gt;        &lt;lgl&gt;       
## 1           10 beer         TRUE        
## 2           25 wine         TRUE</code></pre>
<p>n_max 인자를 통해 전체 데이터가 아닌 지정한 행까지의 데이터만 불러올 수도 있습니다.</p>
</div>
</div>
<div id="텍스트-파일-불러오기" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> 텍스트 파일 불러오기<a class="anchor" aria-label="anchor" href="#%ED%85%8D%EC%8A%A4%ED%8A%B8-%ED%8C%8C%EC%9D%BC-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0"><i class="fas fa-link"></i></a>
</h2>
<p><code>.txt</code> 파일로 저장된 텍스트 파일 역시 <code><a href="https://rdrr.io/r/utils/read.table.html">read.delim()</a></code> 혹은 <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> 함수를 이용해 불러올 수 있습니다.</p>
<div class="sourceCode" id="cb325"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="st">'mydata.txt'</span>, sep <span class="op">=</span> <span class="st">','</span><span class="op">)</span></code></pre></div>
<pre><code>##   variable.1 variable.2 variable.3
## 1         10       beer       TRUE
## 2         25       wine       TRUE
## 3          8     cheese      FALSE</code></pre>
<div class="sourceCode" id="cb327"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">'mydata.txt'</span>, sep <span class="op">=</span> <span class="st">','</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>##   variable.1 variable.2 variable.3
## 1         10       beer       TRUE
## 2         25       wine       TRUE
## 3          8     cheese      FALSE</code></pre>
</div>
<div id="엑셀-파일-불러오기" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> 엑셀 파일 불러오기<a class="anchor" aria-label="anchor" href="#%EC%97%91%EC%85%80-%ED%8C%8C%EC%9D%BC-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0"><i class="fas fa-link"></i></a>
</h2>
<p>엑셀 파일을 불러오기 위한 패키지는 매우 많으며, 이 중 <code>xlsx</code>와 <code>readxl</code> 패키지를 살펴보도록 하겠습니다.</p>
<div id="openxlsx-패키지" class="section level3" number="11.3.1">
<h3>
<span class="header-section-number">11.3.1</span> <code>openxlsx</code> 패키지<a class="anchor" aria-label="anchor" href="#openxlsx-%ED%8C%A8%ED%82%A4%EC%A7%80"><i class="fas fa-link"></i></a>
</h3>
<p><code>openxlsx</code> 패캐지의 <code><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx()</a></code> 함수를 이용해 엑셀 데이터를 불러올 수 있습니다.</p>
<div class="sourceCode" id="cb329"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html">openxlsx</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="st">'mydata.xlsx'</span>, sheet <span class="op">=</span> <span class="st">'Sheet1'</span><span class="op">)</span></code></pre></div>
<pre><code>##   variable.1 variable.2 variable.3
## 1         10       beer       TRUE
## 2         25       wine       TRUE
## 3          8     cheese      FALSE</code></pre>
<div class="sourceCode" id="cb331"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="st">'mydata.xlsx'</span>, sheet <span class="op">=</span> <span class="st">'Sheet2'</span><span class="op">)</span></code></pre></div>
<pre><code>##   variable.4 variable.5
## 1     Dayton     johnny
## 2   Columbus      amber
## 3  Cleveland       tony
## 4 Cincinnati      alice</code></pre>
<p>엑셀은 여러 시트로 구성되어 있으므로, sheet 인자를 통해 원하는 시트명의 내용만 불러올 수 있습니다.</p>
<div class="sourceCode" id="cb333"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="st">'mydata.xlsx'</span>, sheet <span class="op">=</span> <span class="st">'Sheet3'</span><span class="op">)</span></code></pre></div>
<pre><code>##                                          Header.Company.A         X2
## 1 What if we want to disregard header text in Excel file?       &lt;NA&gt;
## 2                                              variable 6 variable 7
## 3                                                     200       Male
## 4                                                     225     Female
## 5                                                     400     Female
## 6                                                     310       Male</code></pre>
<p>간혹 엑셀 파일에는 데이터가 아닌 설명을 위한 텍스트가 적힌 경우도 있으므로, 이를 제외하고 데이터를 불러올 필요가 있습니다.</p>
<div class="sourceCode" id="cb335"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="st">'mydata.xlsx'</span>, sheet <span class="op">=</span> <span class="st">'Sheet3'</span>, startRow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##   variable.6 variable.7
## 1        200       Male
## 2        225     Female
## 3        400     Female
## 4        310       Male</code></pre>
<p>startRow 인자를 통해 3번째 행부터 데이터를 불러오게 되어, 불필요한 텍스트가 제거되었습니다.</p>
<div class="sourceCode" id="cb337"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="st">'mydata.xlsx'</span>, sheet <span class="op">=</span> <span class="st">'Sheet3'</span>, rows <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code>##   variable.6 variable.7
## 1        200       Male
## 2        225     Female</code></pre>
<p>rowIndex 인자를 통해 원하는 행의 데이터만 불러올 수 있습니다.</p>
</div>
<div id="readxl-패키지" class="section level3" number="11.3.2">
<h3>
<span class="header-section-number">11.3.2</span> <code>readxl</code> 패키지<a class="anchor" aria-label="anchor" href="#readxl-%ED%8C%A8%ED%82%A4%EC%A7%80"><i class="fas fa-link"></i></a>
</h3>
<p><code>readxl</code> 패키지는 <code>readr</code> 패키지와 거의 비슷하며, C++을 기반으로 하여 매우 빠른 속도를 자랑합니다.</p>
<div class="sourceCode" id="cb339"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span>

<span class="va">mydata</span> <span class="op">=</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">'mydata.xlsx'</span>, sheet <span class="op">=</span> <span class="st">'Sheet5'</span><span class="op">)</span>
<span class="va">mydata</span></code></pre></div>
<pre><code>## # A tibble: 3 x 5
##   `Variable 1` `Variable 2` `Variable 3` `Variable 4`        `Variable 5`       
##          &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;dttm&gt;              &lt;dttm&gt;             
## 1           10 beer                    1 2015-11-20 00:00:00 2015-11-20 13:30:00
## 2           25 wine                    1 NA                  2015-11-21 16:30:00
## 3            8 &lt;NA&gt;                    0 2015-11-22 00:00:00 2015-11-22 14:45:00</code></pre>
<div class="sourceCode" id="cb341"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></code></pre></div>
<pre><code>## tibble [3 x 5] (S3: tbl_df/tbl/data.frame)
##  $ Variable 1: num [1:3] 10 25 8
##  $ Variable 2: chr [1:3] "beer" "wine" NA
##  $ Variable 3: num [1:3] 1 1 0
##  $ Variable 4: POSIXct[1:3], format: "2015-11-20" NA ...
##  $ Variable 5: POSIXct[1:3], format: "2015-11-20 13:30:00" "2015-11-21 16:30:00" ...</code></pre>
<p><code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code> 함수 역시 sheet 인자를 통해 원하는 시트의 데이터를 불러올 수 있습니다. 빈 칸의 경우 결측치(NA)로 변형되며, 날짜의 경우 POSIXct 형식으로 불러옵니다.</p>
<div class="sourceCode" id="cb343"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">'mydata.xlsx'</span>, sheet <span class="op">=</span> <span class="st">'Sheet5'</span>, skip <span class="op">=</span> <span class="fl">1</span>,
           col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'Var'</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 5
##   `Var 1` `Var 2` `Var 3` `Var 4`             `Var 5`            
##     &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dttm&gt;              &lt;dttm&gt;             
## 1      10 beer          1 2015-11-20 00:00:00 2015-11-20 13:30:00
## 2      25 wine          1 NA                  2015-11-21 16:30:00
## 3       8 &lt;NA&gt;          0 2015-11-22 00:00:00 2015-11-22 14:45:00</code></pre>
<p>skip 인자를 통해 위에서 n 번째까지 행을 건너뛸 수 있으며, col_names 인자를 통해 원하는 열이름을 직접 입력할 수 있습니다.</p>
<p>간혹 결측치가 NA가 아닌 999와 같은 특정 값으로 입력되는 경우도 있으므로, 이를 찾아 NA로 변형해주어야 합니다.</p>
<div class="sourceCode" id="cb345"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">'mydata.xlsx'</span>, sheet <span class="op">=</span> <span class="st">'Sheet6'</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   `variable 1` `variable 2` `variable 3` `variable 4`
##          &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;        &lt;dbl&gt;
## 1           10 beer                    3        42328
## 2           25 wine                    1          999
## 3            8 999                     0        42330</code></pre>
<div class="sourceCode" id="cb347"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">'mydata.xlsx'</span>, sheet <span class="op">=</span> <span class="st">'Sheet6'</span>, na <span class="op">=</span> <span class="st">'999'</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   `variable 1` `variable 2` `variable 3` `variable 4`
##          &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;        &lt;dbl&gt;
## 1           10 beer                    3        42328
## 2           25 wine                    1           NA
## 3            8 &lt;NA&gt;                    0        42330</code></pre>
<p>NA로 지정하고 싶은 값을 직접 입력할 수 있습니다.</p>
<div class="sourceCode" id="cb349"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">'mydata.xlsx'</span>, sheet <span class="op">=</span> <span class="st">'Sheet5'</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 5
##   `Variable 1` `Variable 2` `Variable 3` `Variable 4`        `Variable 5`       
##          &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;dttm&gt;              &lt;dttm&gt;             
## 1           10 beer                    1 2015-11-20 00:00:00 2015-11-20 13:30:00
## 2           25 wine                    1 NA                  2015-11-21 16:30:00
## 3            8 &lt;NA&gt;                    0 2015-11-22 00:00:00 2015-11-22 14:45:00</code></pre>
<div class="sourceCode" id="cb351"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">'mydata.xlsx'</span>, sheet <span class="op">=</span> <span class="st">'Sheet5'</span>,
           col_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'numeric'</span>, <span class="st">'blank'</span>, <span class="st">'numeric'</span>, <span class="st">'blank'</span>, <span class="st">'date'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   `Variable 1` `Variable 3` `Variable 5`       
##          &lt;dbl&gt;        &lt;dbl&gt; &lt;dttm&gt;             
## 1           10            1 2015-11-20 13:30:00
## 2           25            1 2015-11-21 16:30:00
## 3            8            0 2015-11-22 14:45:00</code></pre>
<p>col_types 인자를 통해 원하는 클래스를 직접 입력할 수 있으며, blank를 입력할 경우 해당 셀은 불러오지 않습니다.</p>
</div>
</div>
<div id="r-object-file" class="section level2" number="11.4">
<h2>
<span class="header-section-number">11.4</span> R object File<a class="anchor" aria-label="anchor" href="#r-object-file"><i class="fas fa-link"></i></a>
</h2>
<p>R을 통해 작업한 내용을 csv나 excel 파일이 아닌 Rdata/object 형식(.RData, .rda, .rds)으로 저장하여 공유하는 경우가 있습니다.</p>
<div class="sourceCode" id="cb353"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">'mydata.rds'</span><span class="op">)</span></code></pre></div>
<pre><code>##           V1         V2         V3
## 1 variable 1 variable 2 variable 3
## 2         10       beer       TRUE
## 3         25       wine       TRUE
## 4          8     cheese      FALSE</code></pre>
<p>각 파일 형식에 따라 <code>load('mydata.RData)</code>, <code>load(file = 'mydata.rda)</code>, <code><a href="https://rdrr.io/r/base/readRDS.html">readRDS(mydata.rds)</a></code>와 같은 형태로 데이터를 불러올 수 있습니다.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="missing-value.html"><span class="header-section-number">10</span> Missing Value</a></div>
<div class="next"><a href="exporting-data.html"><span class="header-section-number">12</span> Exporting Data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#import-data"><span class="header-section-number">11</span> Import Data</a></li>
<li>
<a class="nav-link" href="#csv-%ED%8C%8C%EC%9D%BC-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0"><span class="header-section-number">11.1</span> csv 파일 불러오기</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%EA%B8%B0%EB%B3%B8%ED%95%A8%EC%88%98"><span class="header-section-number">11.1.1</span> 기본함수</a></li>
<li><a class="nav-link" href="#readr-%ED%8C%A8%ED%82%A4%EC%A7%80"><span class="header-section-number">11.1.2</span> readr 패키지</a></li>
</ul>
</li>
<li><a class="nav-link" href="#%ED%85%8D%EC%8A%A4%ED%8A%B8-%ED%8C%8C%EC%9D%BC-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0"><span class="header-section-number">11.2</span> 텍스트 파일 불러오기</a></li>
<li>
<a class="nav-link" href="#%EC%97%91%EC%85%80-%ED%8C%8C%EC%9D%BC-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0"><span class="header-section-number">11.3</span> 엑셀 파일 불러오기</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#openxlsx-%ED%8C%A8%ED%82%A4%EC%A7%80"><span class="header-section-number">11.3.1</span> openxlsx 패키지</a></li>
<li><a class="nav-link" href="#readxl-%ED%8C%A8%ED%82%A4%EC%A7%80"><span class="header-section-number">11.3.2</span> readxl 패키지</a></li>
</ul>
</li>
<li><a class="nav-link" href="#r-object-file"><span class="header-section-number">11.4</span> R object File</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R을 이용한 데이터 랭글링</strong>" was written by 이현열 (Henry Lee). </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
